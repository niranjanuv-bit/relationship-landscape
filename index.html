<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>The Relationship Landscape</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea, #764ba2);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }
  </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState } = React;

/* ---------------- ROLE DEFINITIONS ---------------- */

const ROLE_DETAILS = {
  companionate: {
    title: "The Companionate Lover",
    essence: "You show love by building comfort, friendship, and emotional ease.",
    strength: "You create stable, low-drama relationships that last.",
    risk: "Comfort can slide into complacency if you stop actively nurturing connection."
  },
  supportive: {
    title: "The Supportive Lover",
    essence: "You show love by being emotionally present and encouraging growth.",
    strength: "You help partners feel safe, seen, and supported.",
    risk: "You may carry too much emotional weight and neglect your own needs."
  },
  passionate: {
    title: "The Passionate Lover",
    essence: "You show love with intensity, energy, and deep emotional engagement.",
    strength: "You make relationships feel alive and deeply meaningful.",
    risk: "Intensity can overwhelm partners or burn you out if not grounded."
  },
  romantic: {
    title: "The Romantic Lover",
    essence: "You express love through affection, reassurance, and emotional closeness.",
    strength: "You help partners feel deeply desired and emotionally connected.",
    risk: "You may rely on external reassurance instead of inner security."
  },
  pragmatic: {
    title: "The Pragmatic Lover",
    essence: "You show love by building a life, solving problems, and planning ahead.",
    strength: "You create reliable, functional partnerships.",
    risk: "Emotional expression can get overshadowed by practicality."
  },
  sacrificial: {
    title: "The Sacrificial Lover",
    essence: "You love by putting your partner’s needs above your own.",
    strength: "Your devotion creates deep loyalty and care.",
    risk: "You may lose yourself or tolerate unhealthy dynamics."
  }
};

/* ---------------- QUESTIONS ---------------- */

const questions = [
  {
    title: "The House",
    prompt: "You see a house in this landscape. Where is it?",
    options: [
      { label: "In an open field, easy to approach", attachment: "secure", role: "supportive" },
      { label: "On high ground, slightly removed", attachment: "avoidant", role: "pragmatic" },
      { label: "Hidden among trees", attachment: "fearful", role: "sacrificial" },
      { label: "Surrounded by other houses, very close", attachment: "anxious", role: "companionate" }
    ]
  },
  {
    title: "The Door",
    prompt: "What is the door like?",
    options: [
      { label: "Open or unlocked", attachment: "secure", role: "romantic" },
      { label: "Solid and firmly closed", attachment: "avoidant", role: "pragmatic" },
      { label: "Hidden or hard to find", attachment: "fearful", role: "sacrificial" },
      { label: "Transparent — you can see inside", attachment: "anxious", role: "supportive" }
    ]
  },
  {
    title: "Inside the House",
    prompt: "What does the inside feel like?",
    options: [
      { label: "Warm, lived-in, comfortable", attachment: "secure", role: "companionate" },
      { label: "Minimal and functional", attachment: "avoidant", role: "pragmatic" },
      { label: "Cozy but guarded", attachment: "fearful", role: "sacrificial" },
      { label: "Full of memories and reminders", attachment: "anxious", role: "romantic" }
    ]
  },
  {
    title: "Your Distance",
    prompt: "Where are you standing relative to the house?",
    options: [
      { label: "Nearby, with your own space", attachment: "secure", role: "companionate" },
      { label: "At a comfortable distance", attachment: "avoidant", role: "supportive" },
      { label: "Wanting to go closer but hesitating", attachment: "fearful", role: "sacrificial" },
      { label: "Right at the door", attachment: "anxious", role: "passionate" }
    ]
  },
  {
    title: "Someone Appears",
    prompt: "Someone important appears. Where are they?",
    options: [
      { label: "Beside you, energized by your presence", attachment: "secure", role: "passionate" },
      { label: "Nearby but doing their own thing", attachment: "avoidant", role: "companionate" },
      { label: "Close, but uncertain", attachment: "fearful", role: "sacrificial" },
      { label: "Very close, seeking reassurance", attachment: "anxious", role: "romantic" }
    ]
  },
  {
    title: "Ideal Relationship",
    prompt: "At its best, love feels like:",
    options: [
      { label: "A deep friendship", attachment: "secure", role: "companionate" },
      { label: "A strong life partnership", attachment: "avoidant", role: "pragmatic" },
      { label: "Unconditional devotion", attachment: "fearful", role: "sacrificial" },
      { label: "Ongoing romance and spark", attachment: "anxious", role: "romantic" }
    ]
  }
];

/* ---------------- APP ---------------- */

function App() {
  const [step, setStep] = useState(0);
  const [answers, setAnswers] = useState([]);
  const [result, setResult] = useState(null);

  const handleAnswer = (opt) => {
    const next = [...answers, opt];
    setAnswers(next);

    if (step < questions.length - 1) {
      setStep(step + 1);
    } else {
      calculate(next);
    }
  };

  const calculate = (answers) => {
    const roleCounts = {};
    answers.forEach(a => {
      roleCounts[a.role] = (roleCounts[a.role] || 0) + 1;
    });

    const sortedRoles = Object.entries(roleCounts).sort((a,b) => b[1] - a[1]);
    const primary = sortedRoles[0];
    const secondary = sortedRoles[1];

    const secondaryRole =
      secondary && secondary[1] >= primary[1] * 0.75
        ? secondary[0]
        : null;

    setResult({
      primaryRole: primary[0],
      secondaryRole
    });
  };

  if (result) {
    const role = ROLE_DETAILS[result.primaryRole];
    const secondary = result.secondaryRole
      ? ROLE_DETAILS[result.secondaryRole]
      : null;

    return (
      <div className="max-w-xl mx-auto bg-white p-6 rounded-xl shadow-lg">
        <h1 className="text-3xl font-bold text-center mb-6">
          Your Relationship Role
        </h1>

        <h2 className="text-xl font-semibold text-center">
          {role.title}
        </h2>

        <p className="text-gray-600 text-center mt-2">
          {role.essence}
        </p>

        <div className="mt-6 space-y-3">
          <p><strong>Your strength:</strong> {role.strength}</p>
          <p><strong>Watch out for:</strong> {role.risk}</p>
        </div>

        {secondary && (
          <div className="mt-6 p-4 bg-gray-50 rounded-lg">
            <p className="text-sm text-gray-700">
              <strong>You also show traits of:</strong> {secondary.title}
            </p>
          </div>
        )}

        <button
          className="w-full mt-6 py-3 bg-purple-600 text-white rounded-lg font-semibold"
          onClick={() => {
            setStep(0);
            setAnswers([]);
            setResult(null);
          }}
        >
          Take Again
        </button>
      </div>
    );
  }

  const q = questions[step];

  return (
    <div className="max-w-xl mx-auto bg-white p-6 rounded-xl shadow-lg">
      <div className="mb-4 text-sm text-gray-500">
        Question {step + 1} of {questions.length}
      </div>
      <h2 className="text-2xl font-bold mb-2">{q.title}</h2>
      <p className="text-gray-600 mb-6">{q.prompt}</p>

      <div className="space-y-3">
        {q.options.map((o, i) => (
          <button
            key={i}
            onClick={() => handleAnswer(o)}
            className="w-full text-left p-4 border rounded-lg hover:bg-purple-50 hover:border-purple-400"
          >
            {o.label}
          </button>
        ))}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
